<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A break first comprehensive learning path for secure agent-to-agent communication"><meta name=author content="Robert Fischer (robert@fischer3.net)"><link href=https://learn-a2a-security.fischer3.net/presentations/eight-layer-validation/checklist/ rel=canonical><link href=../slides/ rel=prev><link href=../../../supplementary/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Security Checklist - Agentic AI Security Education - fischer³ A2A and MCP Introduction</title><link rel=stylesheet href=../../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../stylesheets/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#eight-layer-input-validation-security-checklist class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Agentic AI Security Education - fischer³ A2A and MCP Introduction" class="md-header__button md-logo" aria-label="Agentic AI Security Education - fischer³ A2A and MCP Introduction" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2M7.5 13A2.5 2.5 0 0 0 5 15.5 2.5 2.5 0 0 0 7.5 18a2.5 2.5 0 0 0 2.5-2.5A2.5 2.5 0 0 0 7.5 13m9 0a2.5 2.5 0 0 0-2.5 2.5 2.5 2.5 0 0 0 2.5 2.5 2.5 2.5 0 0 0 2.5-2.5 2.5 2.5 0 0 0-2.5-2.5"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Agentic AI Security Education - fischer³ A2A and MCP Introduction </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Security Checklist </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/fischer3-net/agentic-security-education.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> fischer³ Agentic Security Education </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../guides/quickstart/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../../a2a/00_A2A_OVERVIEW/ class=md-tabs__link> A2A Protocol </a> </li> <li class=md-tabs__item> <a href=../../../examples/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../../guides/ class=md-tabs__link> Guides </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../ class=md-tabs__link> Presentations </a> </li> <li class=md-tabs__item> <a href=../../../supplementary/ class=md-tabs__link> Supplementary </a> </li> <li class=md-tabs__item> <a href=../../../about/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Agentic AI Security Education - fischer³ A2A and MCP Introduction" class="md-nav__button md-logo" aria-label="Agentic AI Security Education - fischer³ A2A and MCP Introduction" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2M7.5 13A2.5 2.5 0 0 0 5 15.5 2.5 2.5 0 0 0 7.5 18a2.5 2.5 0 0 0 2.5-2.5A2.5 2.5 0 0 0 7.5 13m9 0a2.5 2.5 0 0 0-2.5 2.5 2.5 2.5 0 0 0 2.5 2.5 2.5 2.5 0 0 0 2.5-2.5 2.5 2.5 0 0 0-2.5-2.5"/></svg> </a> Agentic AI Security Education - fischer³ A2A and MCP Introduction </label> <div class=md-nav__source> <a href=https://github.com/fischer3-net/agentic-security-education.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> fischer³ Agentic Security Education </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../guides/quickstart/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/first-agent/ class=md-nav__link> <span class=md-ellipsis> First Agent </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> A2A Protocol </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> A2A Protocol </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../a2a/00_A2A_OVERVIEW/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Fundamentals </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Fundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../a2a/01_FUNDAMENTALS/01_core_concepts/ class=md-nav__link> <span class=md-ellipsis> Core Concepts </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/01_FUNDAMENTALS/02_agent_identity/ class=md-nav__link> <span class=md-ellipsis> Agent Identity </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/01_FUNDAMENTALS/03_message_types/ class=md-nav__link> <span class=md-ellipsis> Message Types </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Discovery </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Discovery </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../a2a/02_DISCOVERY/01_agent_cards/ class=md-nav__link> <span class=md-ellipsis> Agent Cards </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/02_DISCOVERY/02_registry_patterns.md class=md-nav__link> <span class=md-ellipsis> Registry Patterns </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/02_DISCOVERY/03_capability_matching/ class=md-nav__link> <span class=md-ellipsis> Capability Matching </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../a2a/03_SECURITY/01_authentication_overview/ class=md-nav__link> <span class=md-ellipsis> Authentication Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/03_SECURITY/02_authentication_tags/ class=md-nav__link> <span class=md-ellipsis> Authentication Tags </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/03_SECURITY/03_threat_model/ class=md-nav__link> <span class=md-ellipsis> Threat Model </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/03_SECURITY/04_security_best_practices/ class=md-nav__link> <span class=md-ellipsis> Security Best Practices </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/03_SECURITY/05_code_walkthrough_comparison/ class=md-nav__link> <span class=md-ellipsis> Code Walkthrough </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex=0> <span class=md-ellipsis> Communication </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Communication </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../a2a/04_COMMUNICATION/01_protocol_messages/ class=md-nav__link> <span class=md-ellipsis> Protocol Messages </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/04_COMMUNICATION/02_streaming_events/ class=md-nav__link> <span class=md-ellipsis> Streaming & Events </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/04_COMMUNICATION/03_error_handling/ class=md-nav__link> <span class=md-ellipsis> Error Handling </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/04_COMMUNICATION/04_message_validation_patterns/ class=md-nav__link> <span class=md-ellipsis> Message Validation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex=0> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../a2a/05_REFERENCE/01_message_schemas/ class=md-nav__link> <span class=md-ellipsis> Message Schemas </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/05_REFERENCE/02_capability_vocabulary/ class=md-nav__link> <span class=md-ellipsis> Capability Vocabulary </span> </a> </li> <li class=md-nav__item> <a href=../../../a2a/05_REFERENCE/03_protocol_versions/ class=md-nav__link> <span class=md-ellipsis> Protocol Versions </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../../examples/ class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> Crypto Price Agent </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Crypto Price Agent </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/crypto-stage1/ class=md-nav__link> <span class=md-ellipsis> Stage 1 (Vulnerable) </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/crypto-stage2.mdgithub class=md-nav__link> <span class=md-ellipsis> Stage 2 (Improved) </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/crypto-stage3/ class=md-nav__link> <span class=md-ellipsis> Stage 3 (Secure) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class=md-ellipsis> Credit Report Agent </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Credit Report Agent </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/credit-stage1/ class=md-nav__link> <span class=md-ellipsis> Stage 1 (Vulnerable) </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/credit-stage2/ class=md-nav__link> <span class=md-ellipsis> Stage 2 (Improved) </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/credit-stage3/ class=md-nav__link> <span class=md-ellipsis> Stage 3 (Secure) </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/credit-stage4/ class=md-nav__link> <span class=md-ellipsis> Stage 4 (Advanced) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class=md-ellipsis> Task Collaboration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Task Collaboration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/task-stage1/ class=md-nav__link> <span class=md-ellipsis> Stage 1 (Vulnerable) </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/task-stage2/ class=md-nav__link> <span class=md-ellipsis> Stage 2 (Improved) </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/task-stage3/ class=md-nav__link> <span class=md-ellipsis> Stage 3 (Secure) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_5> <label class=md-nav__link for=__nav_4_5 id=__nav_4_5_label tabindex=0> <span class=md-ellipsis> Adversarial Agents </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> Adversarial Agents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/stage1-adversarial/ class=md-nav__link> <span class=md-ellipsis> Stage 1 (Vulnerable) </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/stage2-adversarial/ class=md-nav__link> <span class=md-ellipsis> Stage 2 (Partial) </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/stage3-adversarial/ class=md-nav__link> <span class=md-ellipsis> Stage 3 (Secure) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../../guides/ class="md-nav__link "> <span class=md-ellipsis> Guides </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../guides/presentation-guide/ class=md-nav__link> <span class=md-ellipsis> Creating Presentations </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/running-examples.md class=md-nav__link> <span class=md-ellipsis> Running Examples </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/security-checklist/ class=md-nav__link> <span class=md-ellipsis> Security Checklist </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/implementation-patterns/ class=md-nav__link> <span class=md-ellipsis> Implementation Patterns </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_6> <label class=md-nav__link for=__nav_5_6 id=__nav_5_6_label tabindex=0> <span class=md-ellipsis> Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_6_label aria-expanded=false> <label class=md-nav__title for=__nav_5_6> <span class="md-nav__icon md-icon"></span> Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../a2a/04_COMMUNICATION/04_message_validation_patterns/ class=md-nav__link> <span class=md-ellipsis> Message Validation </span> </a> </li> <li class=md-nav__item> <a href=../slides/ class=md-nav__link> <span class=md-ellipsis> Eight-Layer Validation (Presentation) </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Security Checklist </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Security Checklist </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#for-non-technical-security-professionals class=md-nav__link> <span class=md-ellipsis> For Non-Technical Security Professionals </span> </a> </li> <li class=md-nav__item> <a href=#pre-review-conversation-starters class=md-nav__link> <span class=md-ellipsis> Pre-Review Conversation Starters </span> </a> <nav class=md-nav aria-label="Pre-Review Conversation Starters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#discovery-questions class=md-nav__link> <span class=md-ellipsis> Discovery Questions </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-1-size-validation class=md-nav__link> <span class=md-ellipsis> Layer 1: Size Validation </span> </a> <nav class=md-nav aria-label="Layer 1: Size Validation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-2-extension-validation class=md-nav__link> <span class=md-ellipsis> Layer 2: Extension Validation </span> </a> <nav class=md-nav aria-label="Layer 2: Extension Validation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_1 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers_1 class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_1 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_1 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-3-content-type-validation class=md-nav__link> <span class=md-ellipsis> Layer 3: Content-Type Validation </span> </a> <nav class=md-nav aria-label="Layer 3: Content-Type Validation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_2 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers_2 class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_2 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_2 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-4-magic-byte-validation class=md-nav__link> <span class=md-ellipsis> Layer 4: Magic Byte Validation </span> </a> <nav class=md-nav aria-label="Layer 4: Magic Byte Validation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_3 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers_3 class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_3 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_3 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-5-filename-sanitization class=md-nav__link> <span class=md-ellipsis> Layer 5: Filename Sanitization </span> </a> <nav class=md-nav aria-label="Layer 5: Filename Sanitization"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_4 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers_4 class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_4 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_4 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-6-input-sanitization-injection-prevention class=md-nav__link> <span class=md-ellipsis> Layer 6: Input Sanitization (Injection Prevention) </span> </a> <nav class=md-nav aria-label="Layer 6: Input Sanitization (Injection Prevention)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_5 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers-ai-specific class=md-nav__link> <span class=md-ellipsis> Questions for Developers (AI-Specific) </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_5 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_5 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-7-schema-validation class=md-nav__link> <span class=md-ellipsis> Layer 7: Schema Validation </span> </a> <nav class=md-nav aria-label="Layer 7: Schema Validation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_6 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers_5 class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_6 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_6 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-8-business-logic-validation class=md-nav__link> <span class=md-ellipsis> Layer 8: Business Logic Validation </span> </a> <nav class=md-nav aria-label="Layer 8: Business Logic Validation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_7 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers_6 class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_7 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_7 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#google-gemini-specific-security class=md-nav__link> <span class=md-ellipsis> Google Gemini-Specific Security </span> </a> <nav class=md-nav aria-label="Google Gemini-Specific Security"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#prompt-security class=md-nav__link> <span class=md-ellipsis> Prompt Security </span> </a> </li> <li class=md-nav__item> <a href=#api-security class=md-nav__link> <span class=md-ellipsis> API Security </span> </a> </li> <li class=md-nav__item> <a href=#output-validation class=md-nav__link> <span class=md-ellipsis> Output Validation </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_8 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_8 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing-and-verification class=md-nav__link> <span class=md-ellipsis> Testing and Verification </span> </a> <nav class=md-nav aria-label="Testing and Verification"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#test-coverage-requirements class=md-nav__link> <span class=md-ellipsis> Test Coverage Requirements </span> </a> </li> <li class=md-nav__item> <a href=#monitoring-requirements class=md-nav__link> <span class=md-ellipsis> Monitoring Requirements </span> </a> </li> <li class=md-nav__item> <a href=#documentation-requirements class=md-nav__link> <span class=md-ellipsis> Documentation Requirements </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-gaps-and-red-flags class=md-nav__link> <span class=md-ellipsis> Common Gaps and Red Flags </span> </a> <nav class=md-nav aria-label="Common Gaps and Red Flags"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#red-flags-in-responses class=md-nav__link> <span class=md-ellipsis> Red Flags in Responses </span> </a> </li> <li class=md-nav__item> <a href=#green-flags-in-responses class=md-nav__link> <span class=md-ellipsis> Green Flags in Responses </span> </a> </li> <li class=md-nav__item> <a href=#common-missing-layers class=md-nav__link> <span class=md-ellipsis> Common Missing Layers </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#action-item-template class=md-nav__link> <span class=md-ellipsis> Action Item Template </span> </a> <nav class=md-nav aria-label="Action Item Template"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gap-layer-name-specific-issue class=md-nav__link> <span class=md-ellipsis> Gap: [Layer Name] - [Specific Issue] </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#example-completed-checklist-section class=md-nav__link> <span class=md-ellipsis> Example: Completed Checklist Section </span> </a> <nav class=md-nav aria-label="Example: Completed Checklist Section"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#layer-6-input-sanitization-verified class=md-nav__link> <span class=md-ellipsis> Layer 6: Input Sanitization ✓ VERIFIED </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#summary-assessment class=md-nav__link> <span class=md-ellipsis> Summary Assessment </span> </a> <nav class=md-nav aria-label="Summary Assessment"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overall-security-posture class=md-nav__link> <span class=md-ellipsis> Overall Security Posture </span> </a> </li> <li class=md-nav__item> <a href=#required-actions-before-deployment class=md-nav__link> <span class=md-ellipsis> Required Actions Before Deployment </span> </a> </li> <li class=md-nav__item> <a href=#nice-to-have-improvements class=md-nav__link> <span class=md-ellipsis> Nice-to-Have Improvements </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#checklist-maintenance class=md-nav__link> <span class=md-ellipsis> Checklist Maintenance </span> </a> <nav class=md-nav aria-label="Checklist Maintenance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#review-schedule class=md-nav__link> <span class=md-ellipsis> Review Schedule </span> </a> </li> <li class=md-nav__item> <a href=#version-history class=md-nav__link> <span class=md-ellipsis> Version History </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#contact-information class=md-nav__link> <span class=md-ellipsis> Contact Information </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> Presentations </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Presentations </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2 checked> <label class=md-nav__link for=__nav_6_2 id=__nav_6_2_label tabindex> <span class=md-ellipsis> Eight-Layer Input Validation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_2_label aria-expanded=true> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> Eight-Layer Input Validation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../article/ class=md-nav__link> <span class=md-ellipsis> Article </span> </a> </li> <li class=md-nav__item> <a href=../slides/ class=md-nav__link> <span class=md-ellipsis> Eight-Layer Validation (Presentation) </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Security Checklist </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Security Checklist </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#for-non-technical-security-professionals class=md-nav__link> <span class=md-ellipsis> For Non-Technical Security Professionals </span> </a> </li> <li class=md-nav__item> <a href=#pre-review-conversation-starters class=md-nav__link> <span class=md-ellipsis> Pre-Review Conversation Starters </span> </a> <nav class=md-nav aria-label="Pre-Review Conversation Starters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#discovery-questions class=md-nav__link> <span class=md-ellipsis> Discovery Questions </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-1-size-validation class=md-nav__link> <span class=md-ellipsis> Layer 1: Size Validation </span> </a> <nav class=md-nav aria-label="Layer 1: Size Validation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-2-extension-validation class=md-nav__link> <span class=md-ellipsis> Layer 2: Extension Validation </span> </a> <nav class=md-nav aria-label="Layer 2: Extension Validation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_1 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers_1 class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_1 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_1 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-3-content-type-validation class=md-nav__link> <span class=md-ellipsis> Layer 3: Content-Type Validation </span> </a> <nav class=md-nav aria-label="Layer 3: Content-Type Validation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_2 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers_2 class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_2 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_2 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-4-magic-byte-validation class=md-nav__link> <span class=md-ellipsis> Layer 4: Magic Byte Validation </span> </a> <nav class=md-nav aria-label="Layer 4: Magic Byte Validation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_3 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers_3 class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_3 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_3 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-5-filename-sanitization class=md-nav__link> <span class=md-ellipsis> Layer 5: Filename Sanitization </span> </a> <nav class=md-nav aria-label="Layer 5: Filename Sanitization"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_4 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers_4 class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_4 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_4 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-6-input-sanitization-injection-prevention class=md-nav__link> <span class=md-ellipsis> Layer 6: Input Sanitization (Injection Prevention) </span> </a> <nav class=md-nav aria-label="Layer 6: Input Sanitization (Injection Prevention)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_5 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers-ai-specific class=md-nav__link> <span class=md-ellipsis> Questions for Developers (AI-Specific) </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_5 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_5 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-7-schema-validation class=md-nav__link> <span class=md-ellipsis> Layer 7: Schema Validation </span> </a> <nav class=md-nav aria-label="Layer 7: Schema Validation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_6 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers_5 class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_6 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_6 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layer-8-business-logic-validation class=md-nav__link> <span class=md-ellipsis> Layer 8: Business Logic Validation </span> </a> <nav class=md-nav aria-label="Layer 8: Business Logic Validation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#verification-checklist_7 class=md-nav__link> <span class=md-ellipsis> Verification Checklist </span> </a> </li> <li class=md-nav__item> <a href=#questions-for-developers_6 class=md-nav__link> <span class=md-ellipsis> Questions for Developers </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_7 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_7 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#google-gemini-specific-security class=md-nav__link> <span class=md-ellipsis> Google Gemini-Specific Security </span> </a> <nav class=md-nav aria-label="Google Gemini-Specific Security"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#prompt-security class=md-nav__link> <span class=md-ellipsis> Prompt Security </span> </a> </li> <li class=md-nav__item> <a href=#api-security class=md-nav__link> <span class=md-ellipsis> API Security </span> </a> </li> <li class=md-nav__item> <a href=#output-validation class=md-nav__link> <span class=md-ellipsis> Output Validation </span> </a> </li> <li class=md-nav__item> <a href=#evidence-to-request_8 class=md-nav__link> <span class=md-ellipsis> Evidence to Request </span> </a> </li> <li class=md-nav__item> <a href=#risk-assessment_8 class=md-nav__link> <span class=md-ellipsis> Risk Assessment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing-and-verification class=md-nav__link> <span class=md-ellipsis> Testing and Verification </span> </a> <nav class=md-nav aria-label="Testing and Verification"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#test-coverage-requirements class=md-nav__link> <span class=md-ellipsis> Test Coverage Requirements </span> </a> </li> <li class=md-nav__item> <a href=#monitoring-requirements class=md-nav__link> <span class=md-ellipsis> Monitoring Requirements </span> </a> </li> <li class=md-nav__item> <a href=#documentation-requirements class=md-nav__link> <span class=md-ellipsis> Documentation Requirements </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-gaps-and-red-flags class=md-nav__link> <span class=md-ellipsis> Common Gaps and Red Flags </span> </a> <nav class=md-nav aria-label="Common Gaps and Red Flags"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#red-flags-in-responses class=md-nav__link> <span class=md-ellipsis> Red Flags in Responses </span> </a> </li> <li class=md-nav__item> <a href=#green-flags-in-responses class=md-nav__link> <span class=md-ellipsis> Green Flags in Responses </span> </a> </li> <li class=md-nav__item> <a href=#common-missing-layers class=md-nav__link> <span class=md-ellipsis> Common Missing Layers </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#action-item-template class=md-nav__link> <span class=md-ellipsis> Action Item Template </span> </a> <nav class=md-nav aria-label="Action Item Template"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gap-layer-name-specific-issue class=md-nav__link> <span class=md-ellipsis> Gap: [Layer Name] - [Specific Issue] </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#example-completed-checklist-section class=md-nav__link> <span class=md-ellipsis> Example: Completed Checklist Section </span> </a> <nav class=md-nav aria-label="Example: Completed Checklist Section"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#layer-6-input-sanitization-verified class=md-nav__link> <span class=md-ellipsis> Layer 6: Input Sanitization ✓ VERIFIED </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#summary-assessment class=md-nav__link> <span class=md-ellipsis> Summary Assessment </span> </a> <nav class=md-nav aria-label="Summary Assessment"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overall-security-posture class=md-nav__link> <span class=md-ellipsis> Overall Security Posture </span> </a> </li> <li class=md-nav__item> <a href=#required-actions-before-deployment class=md-nav__link> <span class=md-ellipsis> Required Actions Before Deployment </span> </a> </li> <li class=md-nav__item> <a href=#nice-to-have-improvements class=md-nav__link> <span class=md-ellipsis> Nice-to-Have Improvements </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#checklist-maintenance class=md-nav__link> <span class=md-ellipsis> Checklist Maintenance </span> </a> <nav class=md-nav aria-label="Checklist Maintenance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#review-schedule class=md-nav__link> <span class=md-ellipsis> Review Schedule </span> </a> </li> <li class=md-nav__item> <a href=#version-history class=md-nav__link> <span class=md-ellipsis> Version History </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#contact-information class=md-nav__link> <span class=md-ellipsis> Contact Information </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <div class="md-nav__link md-nav__container"> <a href=../../../supplementary/ class="md-nav__link "> <span class=md-ellipsis> Supplementary </span> </a> <label class="md-nav__link " for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Supplementary </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../supplementary/tools/uv-guide.md class=md-nav__link> <span class=md-ellipsis> UV Package Manager </span> </a> </li> <li class=md-nav__item> <a href=../../../supplementary/tools/link-checker.md class=md-nav__link> <span class=md-ellipsis> Link Checker </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <div class="md-nav__link md-nav__container"> <a href=../../../about/ class="md-nav__link "> <span class=md-ellipsis> About </span> </a> <label class="md-nav__link " for=__nav_8 id=__nav_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../about/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../../about/license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class=md-nav__item> <a href=../../../about/changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=eight-layer-input-validation-security-checklist>Eight-Layer Input Validation Security Checklist<a class=headerlink href=#eight-layer-input-validation-security-checklist title="Permanent link">&para;</a></h1> <h2 id=for-non-technical-security-professionals>For Non-Technical Security Professionals<a class=headerlink href=#for-non-technical-security-professionals title="Permanent link">&para;</a></h2> <p><strong>Purpose</strong>: This checklist guides conversations between Security, Architecture, and Development teams to ensure comprehensive input validation is deployed in agent-to-agent communication systems, particularly those using Google Gemini.</p> <p><strong>How to Use</strong>: - Use this during architecture reviews, pre-deployment security assessments, and security audits - Check each box only when you have verified evidence (code, tests, documentation) - For each unchecked item, create an action item with assigned owner and deadline - Review this checklist at each major release milestone</p> <hr> <h2 id=pre-review-conversation-starters>Pre-Review Conversation Starters<a class=headerlink href=#pre-review-conversation-starters title="Permanent link">&para;</a></h2> <p>Before diving into the technical checklist, use these questions to establish baseline understanding:</p> <h3 id=discovery-questions>Discovery Questions<a class=headerlink href=#discovery-questions title="Permanent link">&para;</a></h3> <ol> <li><strong>"Walk me through what happens when your agent receives a message from an external agent."</strong></li> <li>Purpose: Understand the data flow and identify validation points</li> <li> <p>Listen for: Mention of validation layers, error handling, logging</p> </li> <li> <p><strong>"Where does external input enter your system?"</strong></p> </li> <li>Purpose: Identify all agent boundaries that need validation</li> <li> <p>Listen for: API endpoints, message queues, file uploads, webhooks</p> </li> <li> <p><strong>"How do you currently protect against malicious input?"</strong></p> </li> <li>Purpose: Assess current validation maturity</li> <li> <p>Listen for: Specific layers mentioned, or vague "we validate everything"</p> </li> <li> <p><strong>"Show me your validation documentation."</strong></p> </li> <li>Purpose: Verify validation is documented and maintainable</li> <li> <p>Red flag: "It's mostly in the code..." or "Let me find that..."</p> </li> <li> <p><strong>"Have you had any security incidents related to input validation?"</strong></p> </li> <li>Purpose: Learn from past failures</li> <li>Follow-up: "What validation would have prevented it?"</li> </ol> <hr> <h2 id=layer-1-size-validation>Layer 1: Size Validation<a class=headerlink href=#layer-1-size-validation title="Permanent link">&para;</a></h2> <p><strong>Purpose</strong>: Prevent denial-of-service attacks by limiting message and payload sizes before processing</p> <h3 id=verification-checklist>Verification Checklist<a class=headerlink href=#verification-checklist title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Maximum message size is defined and documented</strong></li> <li>Evidence needed: Configuration file or documentation showing exact limits</li> <li>Typical values: 10MB for messages, 5MB for payloads</li> <li> <p>Ask: "What's our maximum message size and where is it documented?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Maximum payload size is defined for JSON/XML bodies</strong></p> </li> <li>Evidence needed: Separate limit for message body content</li> <li> <p>Ask: "Is the payload size limit different from total message size?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Maximum file upload size is enforced</strong></p> </li> <li>Evidence needed: File upload handler with size checks</li> <li> <p>Ask: "Can someone upload a 1GB file? Show me where we prevent this."</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Maximum string length for individual fields is defined</strong></p> </li> <li>Evidence needed: Field-level validation rules</li> <li> <p>Ask: "What's the maximum length for text fields like 'description' or 'notes'?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Size validation occurs BEFORE parsing or processing</strong></p> </li> <li>Evidence needed: Code showing size check as first step</li> <li>Critical: Size check must happen before <code>json.loads()</code>, <code>xml.parse()</code>, etc.</li> <li> <p>Ask: "Show me the order of operations when a message arrives."</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Oversized requests return appropriate error codes</strong></p> </li> <li>Evidence needed: HTTP 413 (Payload Too Large) responses</li> <li> <p>Ask: "What error code do we return for oversized messages?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Size limits are configurable (not hardcoded)</strong></p> </li> <li>Evidence needed: Configuration file with size limits</li> <li>Ask: "Can we change size limits without modifying code?"</li> </ul> <h3 id=questions-for-developers>Questions for Developers<a class=headerlink href=#questions-for-developers title="Permanent link">&para;</a></h3> <ul> <li>"What happens if an agent sends a 1GB message?"</li> <li>Expected: "It's rejected immediately with 413 error before parsing."</li> <li> <p>Red flag: "We parse it first and then check..."</p> </li> <li> <p>"Where in the code do we check message sizes?"</p> </li> <li>Expected: Shows validation function at entry point</li> <li> <p>Red flag: "Let me search for that..."</p> </li> <li> <p>"Show me the size validation test cases."</p> </li> <li>Expected: Tests with messages at limit, above limit, zero-length</li> <li>Red flag: "We don't have specific tests for that."</li> </ul> <h3 id=evidence-to-request>Evidence to Request<a class=headerlink href=#evidence-to-request title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Configuration file showing all size limits</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Code snippet showing validation at entry point</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Test suite with boundary tests (at limit, above limit, edge cases)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Monitoring dashboard showing size rejection metrics</li> </ul> <h3 id=risk-assessment>Risk Assessment<a class=headerlink href=#risk-assessment title="Permanent link">&para;</a></h3> <p><strong>If this layer is missing:</strong> - Attackers can crash agents with huge messages - Memory exhaustion and disk space depletion - Denial of service to legitimate users - API quota exhaustion (for services like Gemini)</p> <p><strong>Severity if missing</strong>: HIGH</p> <hr> <h2 id=layer-2-extension-validation>Layer 2: Extension Validation<a class=headerlink href=#layer-2-extension-validation title="Permanent link">&para;</a></h2> <p><strong>Purpose</strong>: Verify file extensions match expected types using a whitelist approach</p> <h3 id=verification-checklist_1>Verification Checklist<a class=headerlink href=#verification-checklist_1 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Allowed file extensions are whitelisted (not blacklisted)</strong></li> <li>Evidence needed: Explicit whitelist of allowed extensions</li> <li>Critical: Whitelist approach (allow <code>.json</code>, <code>.csv</code>) not blacklist (block <code>.exe</code>)</li> <li> <p>Ask: "Show me the list of allowed file extensions."</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Whitelist is maintained in configuration, not scattered in code</strong></p> </li> <li>Evidence needed: Single source of truth for allowed extensions</li> <li> <p>Ask: "Where is the extension whitelist defined?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Extension validation is case-insensitive</strong></p> </li> <li>Evidence needed: Handles <code>.JSON</code>, <code>.Json</code>, <code>.json</code> identically</li> <li> <p>Ask: "What happens if someone uploads <code>file.JSON</code> vs <code>file.json</code>?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Double extensions are handled correctly</strong></p> </li> <li>Evidence needed: Detects and blocks <code>file.jpg.exe</code></li> <li> <p>Ask: "How do we handle files like <code>malware.exe.json</code>?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Files without extensions are explicitly handled</strong></p> </li> <li>Evidence needed: Decision to allow or reject extensionless files</li> <li> <p>Ask: "Can someone upload a file named just <code>report</code> with no extension?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Rejected files return clear error messages</strong></p> </li> <li>Evidence needed: Error messages indicate which extension was rejected</li> <li>Ask: "What error message does a user see if they upload a .exe file?"</li> </ul> <h3 id=questions-for-developers_1>Questions for Developers<a class=headerlink href=#questions-for-developers_1 title="Permanent link">&para;</a></h3> <ul> <li>"What file types do we accept? Where is this list?"</li> <li>Expected: Shows configuration file with explicit whitelist</li> <li> <p>Red flag: "We accept most file types except executables..."</p> </li> <li> <p>"How do we handle <code>malware.exe</code> renamed to <code>data.csv</code>?"</p> </li> <li>Expected: "We check extension against whitelist, then validate with magic bytes."</li> <li> <p>Red flag: "The extension says CSV, so we treat it as CSV."</p> </li> <li> <p>"Show me test cases for invalid extensions."</p> </li> <li>Expected: Tests with .exe, .bat, .dll, .sh, .app files</li> <li>Red flag: "We mainly test the happy path..."</li> </ul> <h3 id=evidence-to-request_1>Evidence to Request<a class=headerlink href=#evidence-to-request_1 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Whitelist configuration file</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Code showing extension validation logic </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Test cases with blocked extensions (.exe, .bat, .dll, .sh)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Error message examples</li> </ul> <h3 id=risk-assessment_1>Risk Assessment<a class=headerlink href=#risk-assessment_1 title="Permanent link">&para;</a></h3> <p><strong>If this layer is missing:</strong> - Attackers can upload disguised malware - Executables treated as data files - Potential for remote code execution</p> <p><strong>Severity if missing</strong>: HIGH</p> <hr> <h2 id=layer-3-content-type-validation>Layer 3: Content-Type Validation<a class=headerlink href=#layer-3-content-type-validation title="Permanent link">&para;</a></h2> <p><strong>Purpose</strong>: Verify the claimed content type (HTTP header) matches the actual file type</p> <h3 id=verification-checklist_2>Verification Checklist<a class=headerlink href=#verification-checklist_2 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>HTTP Content-Type headers are validated</strong></li> <li>Evidence needed: Code that checks Content-Type header</li> <li> <p>Ask: "Do we validate the Content-Type header?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Content-Type validation matches expected file type</strong></p> </li> <li>Evidence needed: Mapping of extensions to expected Content-Types</li> <li>Example: <code>.json</code> should have <code>application/json</code></li> <li> <p>Ask: "What Content-Type do we expect for JSON files?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Mismatches between Content-Type and actual content are rejected</strong></p> </li> <li>Evidence needed: Validation that catches mismatches</li> <li> <p>Ask: "What happens if Content-Type says JSON but file is PDF?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Missing Content-Type headers are handled appropriately</strong></p> </li> <li>Evidence needed: Decision to require or infer Content-Type</li> <li> <p>Ask: "Can someone upload a file without a Content-Type header?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Content-Type validation occurs before file processing</strong></p> </li> <li>Evidence needed: Content-Type check before parsing</li> <li>Ask: "When do we check Content-Type in the validation pipeline?"</li> </ul> <h3 id=questions-for-developers_2>Questions for Developers<a class=headerlink href=#questions-for-developers_2 title="Permanent link">&para;</a></h3> <ul> <li>"Do we trust the Content-Type header or verify it?"</li> <li>Expected: "We verify it against the actual file content."</li> <li> <p>Red flag: "We use whatever the header says."</p> </li> <li> <p>"What happens if Content-Type says JSON but file is PDF?"</p> </li> <li>Expected: "Request rejected, error logged."</li> <li> <p>Red flag: "We'd try to parse it and probably fail..."</p> </li> <li> <p>"Show me the Content-Type validation logic."</p> </li> <li>Expected: Code that compares header to actual content</li> <li>Red flag: "We don't really check that..."</li> </ul> <h3 id=evidence-to-request_2>Evidence to Request<a class=headerlink href=#evidence-to-request_2 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Code showing Content-Type header validation</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Mapping of extensions to expected Content-Types</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Test cases with Content-Type mismatches</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Error handling for missing Content-Type headers</li> </ul> <h3 id=risk-assessment_2>Risk Assessment<a class=headerlink href=#risk-assessment_2 title="Permanent link">&para;</a></h3> <p><strong>If this layer is missing:</strong> - Attackers can send malicious files with fake Content-Type headers - Content parsing vulnerabilities can be exploited - Type confusion vulnerabilities</p> <p><strong>Severity if missing</strong>: MEDIUM</p> <hr> <h2 id=layer-4-magic-byte-validation>Layer 4: Magic Byte Validation<a class=headerlink href=#layer-4-magic-byte-validation title="Permanent link">&para;</a></h2> <p><strong>Purpose</strong>: Inspect the first bytes of a file to verify its true type (file signature)</p> <h3 id=verification-checklist_3>Verification Checklist<a class=headerlink href=#verification-checklist_3 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>File signatures (magic bytes) are checked</strong></li> <li>Evidence needed: Code that inspects file headers</li> <li> <p>Ask: "Do we check the actual file signature (magic bytes)?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Magic byte database is maintained for supported file types</strong></p> </li> <li>Evidence needed: List of known signatures for each file type</li> <li>Examples: PDF (<code>%PDF</code>), ZIP (<code>PK</code>), JPEG (<code>0xFF 0xD8 0xFF</code>)</li> <li> <p>Ask: "What magic bytes do we check for each file type?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Validation occurs after Content-Type but before full parsing</strong></p> </li> <li>Evidence needed: Magic byte check in correct order</li> <li> <p>Ask: "When does magic byte validation happen in the pipeline?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Mismatches between magic bytes and declared type are rejected</strong></p> </li> <li>Evidence needed: Validation that catches disguised files</li> <li> <p>Ask: "What happens if magic bytes say PDF but extension says JSON?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Unknown file types are rejected by default</strong></p> </li> <li>Evidence needed: Fail-closed approach for unrecognized signatures</li> <li>Ask: "What do we do with files that have unrecognized magic bytes?"</li> </ul> <h3 id=questions-for-developers_3>Questions for Developers<a class=headerlink href=#questions-for-developers_3 title="Permanent link">&para;</a></h3> <ul> <li>"How do we detect a PDF disguised as JSON?"</li> <li>Expected: "We check the magic bytes and compare to expected signature."</li> <li> <p>Red flag: "We trust the file extension."</p> </li> <li> <p>"What's our magic byte validation library?"</p> </li> <li>Expected: Names specific library (python-magic, file-type, etc.)</li> <li> <p>Red flag: "We wrote our own..." or "We don't do that."</p> </li> <li> <p>"Show me test cases for disguised file types."</p> </li> <li>Expected: Tests with PDF as .json, EXE as .csv, etc.</li> <li>Red flag: "We don't test for that."</li> </ul> <h3 id=evidence-to-request_3>Evidence to Request<a class=headerlink href=#evidence-to-request_3 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Code showing magic byte validation</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Database/list of magic byte signatures</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Library used for file type detection</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Test cases with disguised files</li> </ul> <h3 id=risk-assessment_3>Risk Assessment<a class=headerlink href=#risk-assessment_3 title="Permanent link">&para;</a></h3> <p><strong>If this layer is missing:</strong> - Sophisticated attackers can bypass extension and Content-Type validation - Disguised malware can be uploaded - Exploit files can masquerade as legitimate data</p> <p><strong>Severity if missing</strong>: HIGH</p> <hr> <h2 id=layer-5-filename-sanitization>Layer 5: Filename Sanitization<a class=headerlink href=#layer-5-filename-sanitization title="Permanent link">&para;</a></h2> <p><strong>Purpose</strong>: Remove dangerous characters from filenames to prevent path traversal attacks</p> <h3 id=verification-checklist_4>Verification Checklist<a class=headerlink href=#verification-checklist_4 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Path traversal characters are removed (<code>../</code>, <code>..\\</code>)</strong></li> <li>Evidence needed: Sanitization that strips directory traversal sequences</li> <li> <p>Ask: "How do we handle filenames like <code>../../../../etc/passwd</code>?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Absolute paths are converted to relative paths</strong></p> </li> <li>Evidence needed: Stripping of leading <code>/</code> or <code>C:\</code></li> <li> <p>Ask: "What happens if someone uploads <code>/etc/shadow</code> as a filename?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Special characters are sanitized or rejected</strong></p> </li> <li>Evidence needed: Removal or escaping of special characters</li> <li>Characters: <code>;</code>, <code>|</code>, <code>&amp;</code>, <code>$</code>, <code>`</code>, <code>&lt;</code>, <code>&gt;</code>, <code>(</code>, <code>)</code></li> <li> <p>Ask: "What characters do we allow in filenames?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Unicode characters in filenames are handled safely</strong></p> </li> <li>Evidence needed: Unicode normalization or rejection</li> <li> <p>Ask: "Can someone upload a file with emoji or non-ASCII characters in the name?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Null bytes in filenames are blocked</strong></p> </li> <li>Evidence needed: Detection and rejection of <code>\0</code> in filenames</li> <li> <p>Ask: "Do we check for null bytes in filenames?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Maximum filename length is enforced</strong></p> </li> <li>Evidence needed: Length limit (typically 255 characters)</li> <li> <p>Ask: "What's the maximum filename length we allow?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Files are saved only to designated directories</strong></p> </li> <li>Evidence needed: Hardcoded base path for file storage</li> <li>Ask: "Where do uploaded files get saved? Can this be changed by input?"</li> </ul> <h3 id=questions-for-developers_4>Questions for Developers<a class=headerlink href=#questions-for-developers_4 title="Permanent link">&para;</a></h3> <ul> <li>"How do we prevent <code>../../../../etc/passwd</code> attacks?"</li> <li>Expected: "We strip all path separators and traversal sequences."</li> <li> <p>Red flag: "We sanitize the path..." (path should not be used at all)</p> </li> <li> <p>"Where do uploaded files get saved?"</p> </li> <li>Expected: "Always in <code>/uploads/</code> directory, nowhere else."</li> <li> <p>Red flag: "Depends on the filename..." or "In the path specified..."</p> </li> <li> <p>"Show me the filename sanitization function."</p> </li> <li>Expected: Clear sanitization code removing dangerous characters</li> <li>Red flag: "We use the filename as provided..."</li> </ul> <h3 id=evidence-to-request_4>Evidence to Request<a class=headerlink href=#evidence-to-request_4 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Filename sanitization code</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Test cases with path traversal attempts</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Test cases with special characters</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Documentation of allowed filename characters</li> </ul> <h3 id=risk-assessment_4>Risk Assessment<a class=headerlink href=#risk-assessment_4 title="Permanent link">&para;</a></h3> <p><strong>If this layer is missing:</strong> - Attackers can write files anywhere on the filesystem - Overwrite critical system or application files - Read sensitive files via path traversal - Remote code execution via overwriting executables or libraries</p> <p><strong>Severity if missing</strong>: CRITICAL</p> <hr> <h2 id=layer-6-input-sanitization-injection-prevention>Layer 6: Input Sanitization (Injection Prevention)<a class=headerlink href=#layer-6-input-sanitization-injection-prevention title="Permanent link">&para;</a></h2> <p><strong>Purpose</strong>: Remove or escape characters that could trigger injection attacks (SQL, command, XSS, prompt)</p> <h3 id=verification-checklist_5>Verification Checklist<a class=headerlink href=#verification-checklist_5 title="Permanent link">&para;</a></h3> <h4 id=general-injection-prevention>General Injection Prevention<a class=headerlink href=#general-injection-prevention title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>SQL injection patterns are detected and blocked</strong></li> <li>Evidence needed: Detection of SQL keywords and special characters</li> <li>Patterns: <code>'; DROP TABLE</code>, <code>OR 1=1</code>, <code>UNION SELECT</code>, <code>--</code></li> <li> <p>Ask: "How do we protect against SQL injection?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Command injection patterns are detected and blocked</strong></p> </li> <li>Evidence needed: Detection of shell metacharacters</li> <li>Patterns: <code>;</code>, <code>|</code>, <code>&amp;</code>, <code>$()</code>, <code>`</code>, <code>$(</code>, <code>&gt;</code></li> <li> <p>Ask: "Can someone inject shell commands through our inputs?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>XSS patterns are detected and blocked (if HTML rendering occurs)</strong></p> </li> <li>Evidence needed: Detection of HTML/JavaScript tags</li> <li>Patterns: <code>&lt;script&gt;</code>, <code>javascript:</code>, <code>onerror=</code>, <code>&lt;iframe&gt;</code></li> <li> <p>Ask: "Do we render any user input as HTML? How is it sanitized?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>LDAP injection patterns are blocked</strong></p> </li> <li>Evidence needed: Escaping of LDAP special characters</li> <li>Ask: "Do we query LDAP directories? How are inputs sanitized?"</li> </ul> <h4 id=ai-specific-injection-prevention-critical>AI-Specific Injection Prevention (CRITICAL)<a class=headerlink href=#ai-specific-injection-prevention-critical title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Prompt injection patterns are detected for AI agents</strong></li> <li>Evidence needed: Detection of manipulation phrases</li> <li>Patterns: <ul> <li><code>ignore all previous instructions</code></li> <li><code>disregard all previous</code></li> <li><code>new instructions:</code></li> <li><code>system message:</code></li> <li><code>admin override</code></li> <li><code>your new purpose is</code></li> </ul> </li> <li> <p>Ask: "How do we protect Gemini from prompt injection?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Input sanitization occurs BEFORE AI model processing</strong></p> </li> <li>Evidence needed: Sanitization step before Gemini API call</li> <li>Critical: Must happen before prompt construction</li> <li>Ask: "Show me where we sanitize inputs before sending to Gemini."</li> </ul> <h4 id=database-and-logging>Database and Logging<a class=headerlink href=#database-and-logging title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Log injection patterns (newlines) are sanitized</strong></li> <li>Evidence needed: Stripping or escaping of <code>\n</code>, <code>\r</code></li> <li> <p>Ask: "Can someone inject newlines into log messages?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Parameterized queries are used (SQL injection defense)</strong></p> </li> <li>Evidence needed: Use of prepared statements, not string concatenation</li> <li> <p>Ask: "Show me a database query. Do we use parameterized queries?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Input sanitization occurs before database queries</strong></p> </li> <li>Evidence needed: Sanitization even with parameterized queries (defense-in-depth)</li> <li>Ask: "Do we sanitize inputs even though we use parameterized queries?"</li> </ul> <h3 id=questions-for-developers-ai-specific>Questions for Developers (AI-Specific)<a class=headerlink href=#questions-for-developers-ai-specific title="Permanent link">&para;</a></h3> <ul> <li>"How do we protect against prompt injection in Gemini?"</li> <li>Expected: Shows sanitization function that detects manipulation patterns</li> <li> <p>Red flag: "Gemini has built-in safety features..." (not enough)</p> </li> <li> <p>"Show me the input sanitization for AI prompts."</p> </li> <li>Expected: Code that scans for and blocks injection patterns</li> <li> <p>Red flag: "We just pass the input to Gemini as-is."</p> </li> <li> <p>"What happens if someone inputs: <code>'; DROP TABLE users;--</code>?"</p> </li> <li>Expected: "Injection pattern detected, request blocked, incident logged."</li> <li> <p>Red flag: "That would depend on where it's used..."</p> </li> <li> <p>"Do we use parameterized queries for databases?"</p> </li> <li>Expected: "Yes, always. Never string concatenation."</li> <li>Red flag: "We build queries dynamically..." or "Sometimes..."</li> </ul> <h3 id=evidence-to-request_5>Evidence to Request<a class=headerlink href=#evidence-to-request_5 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Prompt injection detection code</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> List of blocked patterns (SQL, command, XSS, prompt)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Database query code (should use parameterized queries)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Test cases with injection attempts</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Incident logs showing blocked injections</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Sanitization library or functions used</li> </ul> <h3 id=risk-assessment_5>Risk Assessment<a class=headerlink href=#risk-assessment_5 title="Permanent link">&para;</a></h3> <p><strong>If this layer is missing:</strong> - SQL injection: Database destruction, data theft - Command injection: Remote code execution - XSS: Session hijacking, credential theft - Prompt injection: AI behavior manipulation, policy bypasses - Log injection: Log forgery, monitoring evasion</p> <p><strong>Severity if missing</strong>: CRITICAL</p> <p><strong>Note</strong>: This is the most important layer for AI agent security.</p> <hr> <h2 id=layer-7-schema-validation>Layer 7: Schema Validation<a class=headerlink href=#layer-7-schema-validation title="Permanent link">&para;</a></h2> <p><strong>Purpose</strong>: Validate that JSON/XML structure matches expected format</p> <h3 id=verification-checklist_6>Verification Checklist<a class=headerlink href=#verification-checklist_6 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>JSON/XML schemas are formally defined and documented</strong></li> <li>Evidence needed: Schema definition files (JSON Schema, XSD, OpenAPI)</li> <li> <p>Ask: "Where are our message schemas defined?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>All required fields are validated</strong></p> </li> <li>Evidence needed: List of required fields in schema</li> <li> <p>Ask: "What fields are required in each message type?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Field types are validated</strong></p> </li> <li>Evidence needed: Type checking (string, integer, boolean, array, object)</li> <li> <p>Ask: "How do we validate field types?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Nested object structures are validated recursively</strong></p> </li> <li>Evidence needed: Schema validation for nested objects</li> <li> <p>Ask: "Do we validate nested JSON structures?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Array lengths are validated</strong></p> </li> <li>Evidence needed: Minimum and maximum array sizes</li> <li> <p>Ask: "Can someone send an array with 1 million items?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Unknown fields are handled appropriately</strong></p> </li> <li>Evidence needed: Decision to reject strict or ignore additional fields</li> <li> <p>Ask: "What happens if a message contains unexpected fields?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Schema validation occurs after sanitization but before business logic</strong></p> </li> <li>Evidence needed: Correct ordering in validation pipeline</li> <li> <p>Ask: "When does schema validation happen relative to other checks?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Schema validation errors provide clear messages</strong></p> </li> <li>Evidence needed: Error messages indicate which field failed validation</li> <li> <p>Ask: "What error message does a user see for schema validation failures?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Error messages don't leak sensitive information</strong></p> </li> <li>Evidence needed: Generic errors for external users, detailed errors in logs</li> <li>Ask: "Do our error messages expose internal field names or structure?"</li> </ul> <h3 id=questions-for-developers_5>Questions for Developers<a class=headerlink href=#questions-for-developers_5 title="Permanent link">&para;</a></h3> <ul> <li>"Where are our message schemas defined?"</li> <li>Expected: Shows schema definition files (JSON Schema, OpenAPI, etc.)</li> <li> <p>Red flag: "They're kind of implicit in the code..."</p> </li> <li> <p>"What happens if a required field is missing?"</p> </li> <li>Expected: "Validation fails immediately with specific error message."</li> <li> <p>Red flag: "We have default values..." or "The code handles nulls..."</p> </li> <li> <p>"Do we validate nested JSON structures?"</p> </li> <li>Expected: "Yes, recursively to all levels."</li> <li> <p>Red flag: "We validate the top level..."</p> </li> <li> <p>"Show me the schema validation test suite."</p> </li> <li>Expected: Comprehensive tests for missing fields, wrong types, etc.</li> <li>Red flag: "We test the main cases..."</li> </ul> <h3 id=evidence-to-request_6>Evidence to Request<a class=headerlink href=#evidence-to-request_6 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Schema definition files</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Schema validation library in use (ajv, jsonschema, etc.)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Test cases with:</li> <li>Missing required fields</li> <li>Wrong field types</li> <li>Invalid nested structures</li> <li>Extra unknown fields</li> <li>Arrays exceeding limits</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Documentation of error messages</li> </ul> <h3 id=risk-assessment_6>Risk Assessment<a class=headerlink href=#risk-assessment_6 title="Permanent link">&para;</a></h3> <p><strong>If this layer is missing:</strong> - Application crashes from missing fields - Type confusion vulnerabilities - Buffer overflows from oversized arrays - Logic errors from malformed data - Denial of service from deeply nested structures</p> <p><strong>Severity if missing</strong>: HIGH</p> <hr> <h2 id=layer-8-business-logic-validation>Layer 8: Business Logic Validation<a class=headerlink href=#layer-8-business-logic-validation title="Permanent link">&para;</a></h2> <p><strong>Purpose</strong>: Validate that data makes sense in business context, beyond technical correctness</p> <h3 id=verification-checklist_7>Verification Checklist<a class=headerlink href=#verification-checklist_7 title="Permanent link">&para;</a></h3> <h4 id=numeric-validation>Numeric Validation<a class=headerlink href=#numeric-validation title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Numeric ranges are validated</strong></li> <li>Evidence needed: Validation of min/max values</li> <li>Examples: Credit scores (300-850), percentages (0-100), amounts (&gt;0)</li> <li> <p>Ask: "How do we validate that numeric values are realistic?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Currency amounts are validated</strong></p> </li> <li>Evidence needed: No negative prices, reasonable ranges</li> <li>Ask: "Can someone submit a negative price or amount?"</li> </ul> <h4 id=date-and-time-validation>Date and Time Validation<a class=headerlink href=#date-and-time-validation title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Date ranges are validated</strong></li> <li>Evidence needed: No future dates for past events, reasonable ranges</li> <li> <p>Ask: "Can someone claim a birth date in the future?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Temporal consistency is checked</strong></p> </li> <li>Evidence needed: Start dates before end dates, etc.</li> <li>Ask: "Do we check that start dates come before end dates?"</li> </ul> <h4 id=cross-field-validation>Cross-Field Validation<a class=headerlink href=#cross-field-validation title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Business rules are enforced</strong></li> <li>Evidence needed: Complex validations across multiple fields</li> <li>Examples: Balance ≤ credit limit, age ≥ 18 for contracts</li> <li> <p>Ask: "What business rules do we enforce beyond data types?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Cross-field consistency is checked</strong></p> </li> <li>Evidence needed: Validations that compare multiple fields</li> <li>Ask: "Do we validate relationships between fields?"</li> </ul> <h4 id=referential-integrity>Referential Integrity<a class=headerlink href=#referential-integrity title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Referential integrity is validated</strong></li> <li>Evidence needed: Foreign keys exist, references are valid</li> <li> <p>Ask: "Do we verify that referenced entities exist?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Workflow state transitions are validated</strong></p> </li> <li>Evidence needed: Only valid state transitions allowed</li> <li>Example: Can't go from "pending" to "completed" without "in_progress"</li> <li>Ask: "Can someone skip workflow states?"</li> </ul> <h4 id=error-handling>Error Handling<a class=headerlink href=#error-handling title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Business rule violations return meaningful errors</strong></li> <li>Evidence needed: Errors explain what business rule was violated</li> <li>Ask: "What error message does someone get for invalid business logic?"</li> </ul> <h3 id=questions-for-developers_6>Questions for Developers<a class=headerlink href=#questions-for-developers_6 title="Permanent link">&para;</a></h3> <ul> <li>"How do we validate that credit scores are realistic?"</li> <li>Expected: "We check they're in the 300-850 range."</li> <li> <p>Red flag: "We validate it's a number..."</p> </li> <li> <p>"What business rules are enforced beyond data types?"</p> </li> <li>Expected: Lists specific business logic validations</li> <li> <p>Red flag: "We trust the data if it parses..."</p> </li> <li> <p>"Show me validation for cross-field consistency."</p> </li> <li>Expected: Code checking relationships between fields</li> <li> <p>Red flag: "Each field is validated independently..."</p> </li> <li> <p>"What happens with logically impossible data?"</p> </li> <li>Expected: "It's rejected with a clear error message."</li> <li>Red flag: "We'd probably catch it later in processing..."</li> </ul> <h3 id=evidence-to-request_7>Evidence to Request<a class=headerlink href=#evidence-to-request_7 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Documentation of business rules</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Business logic validation code</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Test cases with:</li> <li>Out-of-range values</li> <li>Negative amounts where not allowed</li> <li>Invalid state transitions</li> <li>Inconsistent cross-field data</li> <li>Missing references</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Examples of business rule error messages</li> </ul> <h3 id=risk-assessment_7>Risk Assessment<a class=headerlink href=#risk-assessment_7 title="Permanent link">&para;</a></h3> <p><strong>If this layer is missing:</strong> - Incorrect business decisions based on nonsense data - Financial losses from invalid transactions - Compliance violations - Data corruption - Workflow bypasses</p> <p><strong>Severity if missing</strong>: MEDIUM to HIGH (depends on application)</p> <hr> <h2 id=google-gemini-specific-security>Google Gemini-Specific Security<a class=headerlink href=#google-gemini-specific-security title="Permanent link">&para;</a></h2> <p><strong>Additional validation requirements for Gemini-powered agents</strong></p> <h3 id=prompt-security>Prompt Security<a class=headerlink href=#prompt-security title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>System prompts are stored securely (not in message history)</strong></li> <li>Evidence needed: System prompts in configuration, not conversation</li> <li> <p>Ask: "Where are Gemini system prompts stored?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>User inputs are sanitized before inclusion in prompts</strong></p> </li> <li>Evidence needed: Sanitization before prompt construction</li> <li> <p>Ask: "Show me how we build prompts. Where is input sanitized?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Prompt injection patterns are detected and blocked</strong></p> </li> <li>Evidence needed: Layer 6 sanitization applied to all AI inputs</li> <li> <p>Ask: "How do we prevent prompt injection specifically?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Conversation context is validated at each turn</strong></p> </li> <li>Evidence needed: Validation of previous messages in conversation</li> <li> <p>Ask: "Do we validate the entire conversation history or just new messages?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Hard limits on prompt length are enforced</strong></p> </li> <li>Evidence needed: Maximum token/character limits</li> <li> <p>Ask: "What's the maximum prompt length we allow?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Safety settings are configured appropriately</strong></p> </li> <li>Evidence needed: Gemini safety settings configuration</li> <li>Ask: "What safety settings do we use for Gemini API calls?"</li> </ul> <h3 id=api-security>API Security<a class=headerlink href=#api-security title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>API keys are stored in secure vaults, not code</strong></li> <li>Evidence needed: Secrets management system (AWS Secrets Manager, HashiCorp Vault)</li> <li> <p>Ask: "Where are Gemini API keys stored?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>API rate limits are monitored and enforced locally</strong></p> </li> <li>Evidence needed: Local rate limiting before hitting API limits</li> <li> <p>Ask: "How do we prevent exhausting Gemini API rate limits?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>API quota exhaustion is handled gracefully</strong></p> </li> <li>Evidence needed: Error handling for quota exceeded</li> <li> <p>Ask: "What happens if we exceed Gemini API quota?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Error responses from Gemini are parsed safely</strong></p> </li> <li>Evidence needed: Safe parsing of API error responses</li> <li> <p>Ask: "How do we handle errors from Gemini API?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Retry logic includes exponential backoff</strong></p> </li> <li>Evidence needed: Retry with increasing delays</li> <li> <p>Ask: "Do we retry failed Gemini API calls? How?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>All API calls are logged for audit</strong></p> </li> <li>Evidence needed: Logging of all Gemini interactions</li> <li>Ask: "Do we log all calls to Gemini API?"</li> </ul> <h3 id=output-validation>Output Validation<a class=headerlink href=#output-validation title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Gemini outputs are parsed and validated</strong></li> <li>Evidence needed: Validation of AI responses before use</li> <li> <p>Ask: "Do we validate Gemini's responses before acting on them?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>JSON outputs are schema-validated before use</strong></p> </li> <li>Evidence needed: Schema validation (Layer 7) applied to AI outputs</li> <li> <p>Ask: "If Gemini generates JSON, do we validate it?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Function calling parameters are validated before execution</strong></p> </li> <li>Evidence needed: Validation of parameters Gemini suggests</li> <li> <p>Ask: "If Gemini suggests calling a function, do we validate the parameters?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Hallucinated data is detected and rejected</strong></p> </li> <li>Evidence needed: Validation that catches nonsense outputs</li> <li> <p>Ask: "How do we detect when Gemini hallucinates?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Gemini responses are sanitized before display to users</strong></p> </li> <li>Evidence needed: Sanitization of AI output (XSS prevention)</li> <li> <p>Ask: "Do we sanitize Gemini's responses before showing them to users?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Maximum output length is enforced</strong></p> </li> <li>Evidence needed: Truncation or rejection of oversized responses</li> <li>Ask: "Can Gemini return an unlimited amount of text?"</li> </ul> <h3 id=evidence-to-request_8>Evidence to Request<a class=headerlink href=#evidence-to-request_8 title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Gemini API integration code</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Prompt construction code</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> API key storage configuration</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Safety settings configuration</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Output validation code</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Function calling validation code</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Error handling for API failures</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Audit logs of Gemini interactions</li> </ul> <h3 id=risk-assessment_8>Risk Assessment<a class=headerlink href=#risk-assessment_8 title="Permanent link">&para;</a></h3> <p><strong>If Gemini-specific validation is missing:</strong> - Prompt injection manipulates AI behavior - API quota exhaustion (DoS) - Execution of hallucinated or malicious function calls - Exposure of sensitive data in prompts - XSS via unsanitized AI outputs</p> <p><strong>Severity if missing</strong>: CRITICAL</p> <hr> <h2 id=testing-and-verification>Testing and Verification<a class=headerlink href=#testing-and-verification title="Permanent link">&para;</a></h2> <h3 id=test-coverage-requirements>Test Coverage Requirements<a class=headerlink href=#test-coverage-requirements title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>All eight layers have automated tests</strong></li> <li>Evidence needed: Test suite covering each validation layer</li> <li> <p>Ask: "Show me tests for each validation layer."</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Tests include both positive and negative cases</strong></p> </li> <li>Positive: Valid inputs that should pass</li> <li>Negative: Invalid inputs that should be rejected</li> <li> <p>Ask: "Do we test both valid and invalid inputs?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Tests cover boundary conditions</strong></p> </li> <li>Evidence needed: Tests at limits (max size, min/max values)</li> <li> <p>Ask: "Do we test edge cases and boundaries?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Security tests are part of CI/CD pipeline</strong></p> </li> <li>Evidence needed: Security tests run automatically on every commit</li> <li> <p>Ask: "Do security tests run automatically?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Penetration testing includes injection attacks</strong></p> </li> <li>Evidence needed: Regular pentesting with injection attempts</li> <li>Ask: "When was the last penetration test? What did it cover?"</li> </ul> <h3 id=monitoring-requirements>Monitoring Requirements<a class=headerlink href=#monitoring-requirements title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Validation failures are logged</strong></li> <li>Evidence needed: Logs showing which layer rejected which requests</li> <li> <p>Ask: "Can we see logs of validation failures?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Metrics are collected for each layer</strong></p> </li> <li>Evidence needed: Dashboard showing rejection counts by layer</li> <li> <p>Ask: "Show me validation metrics."</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Alerts are configured for suspicious patterns</strong></p> </li> <li>Evidence needed: Alerts for repeated failures, injection attempts</li> <li> <p>Ask: "Do we get alerts for validation anomalies?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Logs include enough context for investigation</strong></p> </li> <li>Evidence needed: Logs with agent ID, timestamp, layer, reason</li> <li> <p>Ask: "If an attack is blocked, do we have enough info to investigate?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Logs don't expose sensitive data</strong></p> </li> <li>Evidence needed: Sanitized or redacted content in logs</li> <li>Ask: "Do our logs contain PII or sensitive data?"</li> </ul> <h3 id=documentation-requirements>Documentation Requirements<a class=headerlink href=#documentation-requirements title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Validation rules are documented</strong></li> <li>Evidence needed: Documentation of all validation layers</li> <li> <p>Ask: "Where is validation logic documented?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Error codes are documented</strong></p> </li> <li>Evidence needed: List of error codes and their meanings</li> <li> <p>Ask: "Do we have a list of validation error codes?"</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Security runbooks exist for validation failures</strong></p> </li> <li>Evidence needed: Procedures for responding to suspicious validation failures</li> <li>Ask: "What do we do when we detect an attack attempt?"</li> </ul> <hr> <h2 id=common-gaps-and-red-flags>Common Gaps and Red Flags<a class=headerlink href=#common-gaps-and-red-flags title="Permanent link">&para;</a></h2> <h3 id=red-flags-in-responses>Red Flags in Responses<a class=headerlink href=#red-flags-in-responses title="Permanent link">&para;</a></h3> <p>When you hear these, dig deeper:</p> <ul> <li>❌ <strong>"We haven't thought about that..."</strong> - Basic security missing</li> <li>❌ <strong>"The AI handles that automatically..."</strong> - Over-reliance on AI safety</li> <li>❌ <strong>"We trust our internal agents..."</strong> - No internal validation</li> <li>❌ <strong>"That's an edge case we'll handle later..."</strong> - Security is postponed</li> <li>❌ <strong>"We validate where it makes sense..."</strong> - Incomplete validation</li> <li>❌ <strong>"Let me find that code..."</strong> - Validation might not exist</li> <li>❌ <strong>"We built our own validation..."</strong> - NIH syndrome, likely has gaps</li> <li>❌ <strong>"That's on the roadmap..."</strong> - Not currently implemented</li> </ul> <h3 id=green-flags-in-responses>Green Flags in Responses<a class=headerlink href=#green-flags-in-responses title="Permanent link">&para;</a></h3> <p>When you hear these, you're on the right track:</p> <ul> <li>✅ <strong>Shows you code and configuration immediately</strong></li> <li>✅ <strong>Has comprehensive test suites</strong></li> <li>✅ <strong>Monitoring and alerting in place</strong></li> <li>✅ <strong>Clear, up-to-date documentation</strong></li> <li>✅ <strong>Regular security reviews scheduled</strong></li> <li>✅ <strong>Metrics dashboard available</strong></li> <li>✅ <strong>Can walk through validation pipeline in detail</strong></li> </ul> <h3 id=common-missing-layers>Common Missing Layers<a class=headerlink href=#common-missing-layers title="Permanent link">&para;</a></h3> <p>Based on common gaps in production systems:</p> <ol> <li><strong>Layer 1 (Size) often missing</strong>: Many assume framework handles this</li> <li><strong>Layer 4 (Magic Bytes) frequently skipped</strong>: Considered "overkill"</li> <li><strong>Layer 6 (Injection) incomplete</strong>: Only SQL covered, not prompt injection</li> <li><strong>Layer 8 (Business Logic) rarely comprehensive</strong>: Only basic checks</li> </ol> <hr> <h2 id=action-item-template>Action Item Template<a class=headerlink href=#action-item-template title="Permanent link">&para;</a></h2> <p>When you find gaps, use this template to track remediation:</p> <h3 id=gap-layer-name-specific-issue>Gap: [Layer Name] - [Specific Issue]<a class=headerlink href=#gap-layer-name-specific-issue title="Permanent link">&para;</a></h3> <p><strong>Severity</strong>: [Critical / High / Medium / Low]</p> <p><strong>Current State</strong>: [What exists now]</p> <p><strong>Gap</strong>: [What's missing]</p> <p><strong>Risk</strong>: [What could happen without this]</p> <p><strong>Remediation</strong>: - [ ] Task 1: [Specific action] - [ ] Task 2: [Specific action] - [ ] Task 3: [Specific action]</p> <p><strong>Owner</strong>: [Name]</p> <p><strong>Due Date</strong>: [Date]</p> <p><strong>Verification</strong>: [How will we verify this is fixed?]</p> <p><strong>Follow-up Review</strong>: [Date to re-check]</p> <hr> <h2 id=example-completed-checklist-section>Example: Completed Checklist Section<a class=headerlink href=#example-completed-checklist-section title="Permanent link">&para;</a></h2> <p>Here's how a completed section should look:</p> <h3 id=layer-6-input-sanitization-verified>Layer 6: Input Sanitization ✓ VERIFIED<a class=headerlink href=#layer-6-input-sanitization-verified title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> SQL injection patterns detected</li> <li><strong>Evidence</strong>: Code review of <code>security/sanitizer.py</code> line 145-178</li> <li><strong>Test coverage</strong>: <code>tests/test_sql_injection.py</code> with 25 test cases</li> <li> <p><strong>Last verified</strong>: 2024-03-15 by J. Smith</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Prompt injection patterns detected</p> </li> <li><strong>Evidence</strong>: <code>ai/prompt_guard.py</code> blocks 15 manipulation patterns</li> <li><strong>Test coverage</strong>: <code>tests/test_prompt_injection.py</code> with 32 test cases</li> <li> <p><strong>Last verified</strong>: 2024-03-15 by J. Smith</p> </li> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Sanitization before AI processing</p> </li> <li><strong>Evidence</strong>: <code>ai/gemini_client.py</code> line 67 calls sanitizer</li> <li><strong>Test coverage</strong>: Integration tests verify order</li> <li><strong>Last verified</strong>: 2024-03-15 by J. Smith</li> </ul> <p><strong>Overall Layer 6 Status</strong>: ✅ PASS - All requirements met</p> <hr> <h2 id=summary-assessment>Summary Assessment<a class=headerlink href=#summary-assessment title="Permanent link">&para;</a></h2> <h3 id=overall-security-posture>Overall Security Posture<a class=headerlink href=#overall-security-posture title="Permanent link">&para;</a></h3> <p>After completing this checklist, provide an overall assessment:</p> <p><strong>Layers Fully Implemented</strong>: ___ / 8</p> <p><strong>Critical Gaps Identified</strong>: ___</p> <p><strong>High-Priority Gaps</strong>: ___</p> <p><strong>Medium-Priority Gaps</strong>: ___</p> <p><strong>Overall Risk Rating</strong>: [Low / Medium / High / Critical]</p> <p><strong>Recommendation</strong>: [Approve for deployment / Conditional approval / Require remediation before deployment]</p> <h3 id=required-actions-before-deployment>Required Actions Before Deployment<a class=headerlink href=#required-actions-before-deployment title="Permanent link">&para;</a></h3> <p>List critical items that MUST be addressed:</p> <ol> <li>[Critical item 1]</li> <li>[Critical item 2]</li> <li>[Critical item 3]</li> </ol> <h3 id=nice-to-have-improvements>Nice-to-Have Improvements<a class=headerlink href=#nice-to-have-improvements title="Permanent link">&para;</a></h3> <p>List items that would improve security but aren't blockers:</p> <ol> <li>[Improvement 1]</li> <li>[Improvement 2]</li> <li>[Improvement 3]</li> </ol> <hr> <h2 id=checklist-maintenance>Checklist Maintenance<a class=headerlink href=#checklist-maintenance title="Permanent link">&para;</a></h2> <h3 id=review-schedule>Review Schedule<a class=headerlink href=#review-schedule title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Monthly</strong>: Review validation metrics</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Quarterly</strong>: Update checklist based on new threats</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Annually</strong>: Full security audit with external pentesting</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Per Release</strong>: Complete checklist for major releases</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Post-Incident</strong>: Review and update after any security incident</li> </ul> <h3 id=version-history>Version History<a class=headerlink href=#version-history title="Permanent link">&para;</a></h3> <ul> <li>Version 1.0 - Initial checklist (YYYY-MM-DD)</li> <li>Version 1.1 - Added Gemini-specific items (YYYY-MM-DD)</li> <li>Version 1.2 - Updated based on OWASP changes (YYYY-MM-DD)</li> </ul> <hr> <h2 id=contact-information>Contact Information<a class=headerlink href=#contact-information title="Permanent link">&para;</a></h2> <p><strong>Security Team Contact</strong>: [email@company.com]</p> <p><strong>Architecture Review Requests</strong>: [process/URL]</p> <p><strong>Security Incident Reporting</strong>: [incident-response@company.com]</p> <p><strong>Questions About This Checklist</strong>: [security-questions@company.com]</p> <hr> <p><strong>END OF CHECKLIST</strong></p> <p><strong>Remember</strong>: This checklist is a conversation tool, not a compliance checkbox. Use it to ensure genuine security, not just paper compliance.</p> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve by opening an issue. </div> </div> </div> </fieldset> </form> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../slides/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Eight-Layer Validation (Presentation)"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Eight-Layer Validation (Presentation) </div> </div> </a> <a href=../../../supplementary/ class="md-footer__link md-footer__link--next" aria-label="Next: Tools & Utilities"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Tools & Utilities </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2026 fischer³ (fischer3.net), MIT License </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/robertfischer3/fischer3_a2a_introduction target=_blank rel=noopener title="GitHub Repository" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "navigation.footer", "navigation.indexes", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=../../../javascripts/extra.js></script> </body> </html>