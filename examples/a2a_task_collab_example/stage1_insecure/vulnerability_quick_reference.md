# Stage 1 Vulnerability Quick Reference

> One-page reference of all 25+ vulnerabilities in Stage 1

---

## üéØ Session Management (8 vulnerabilities)

| # | Vulnerability | Severity | Location | Impact |
|---|--------------|----------|----------|--------|
| 1 | **Predictable Session IDs** | CRITICAL | Line 45 | Easy to guess (sess_1, sess_2...) |
| 2 | **No Session Validation** | CRITICAL | Throughout | Never checks if session valid |
| 3 | **No Session Timeouts** | CRITICAL | Session storage | Sessions never expire |
| 4 | **No Session Binding** | CRITICAL | Session creation | No IP/fingerprint binding |
| 5 | **Shared Sessions** | HIGH | Session logic | Multiple agents = same session |
| 6 | **Sessions Persist After Logout** | CRITICAL | `handle_logout()` | Logout doesn't destroy session |
| 7 | **No Concurrent Session Limits** | MEDIUM | Session creation | Unlimited sessions/agent |
| 8 | **Session State Plaintext** | HIGH | Session storage | No encryption |

**Quick Test**: Run client ‚Üí option 6 (Session Hijacking Demo)

---

## üóÑÔ∏è State Management (6 vulnerabilities)

| # | Vulnerability | Severity | Location | Impact |
|---|--------------|----------|----------|--------|
| 9 | **No State Validation** | HIGH | State operations | Accepts corrupt data |
| 10 | **State Not Encrypted** | HIGH | State storage | Plaintext in memory |
| 11 | **Stale Permissions** | CRITICAL | Session data | Role changes not reflected |
| 12 | **No State Synchronization** | MEDIUM | Multi-agent | Inconsistent state |
| 13 | **State Corruption Possible** | HIGH | State updates | No integrity checks |
| 14 | **No State Backup** | MEDIUM | Storage | Loss on crash |

**Quick Test**: Run client ‚Üí option 8 (Stale Permissions Demo)

---

## üîê Authentication (4 vulnerabilities)

| # | Vulnerability | Severity | Location | Impact |
|---|--------------|----------|----------|--------|
| 15 | **No Authentication** | CRITICAL | All handlers | Anyone can connect |
| 16 | **No Identity Verification** | CRITICAL | `handle_login()` | Agents claim any identity |
| 17 | **No Signature Validation** | CRITICAL | Message processing | Messages not verified |
| 18 | **Anyone Can Be Coordinator** | CRITICAL | Login | No privilege verification |

**Quick Test**: Try logging in with any agent_id and role="admin"

---

## üö™ Authorization (3 vulnerabilities)

| # | Vulnerability | Severity | Location | Impact |
|---|--------------|----------|----------|--------|
| 19 | **No RBAC** | CRITICAL | All operations | No permission checks |
| 20 | **Any Agent = Any Action** | CRITICAL | Throughout | No restrictions |
| 21 | **Trivial Privilege Escalation** | CRITICAL | Login | Just claim admin |

**Quick Test**: Login as "user" role, still can create projects

---

## üõ°Ô∏è Attack Prevention (4 vulnerabilities)

| # | Vulnerability | Severity | Location | Impact |
|---|--------------|----------|----------|--------|
| 22 | **No Replay Protection** | CRITICAL | Message handling | Same request works ‚àû times |
| 23 | **No Rate Limiting** | HIGH | All endpoints | Flood attacks possible |
| 24 | **Session Hijacking Trivial** | CRITICAL | Session handling | Just copy session ID |
| 25 | **Session Fixation Possible** | CRITICAL | Session creation | Attacker sets session |

**Quick Test**: Run client ‚Üí option 9 (Replay Attack Demo)

---

## üìä Vulnerability Summary

### By Severity

- **CRITICAL** (18): Immediate exploitation, complete compromise
- **HIGH** (5): Serious impact, easy exploitation  
- **MEDIUM** (2): Moderate impact

### By Category

- **Session Management**: 8 vulnerabilities
- **State Management**: 6 vulnerabilities
- **Authentication**: 4 vulnerabilities
- **Authorization**: 3 vulnerabilities
- **Attack Prevention**: 4 vulnerabilities

---

## üéÆ Testing Each Vulnerability

### Quick Test Commands

**Session Hijacking**:
```bash
# Run client ‚Üí option 6
# Shows how to steal and reuse sessions
```

**Session Fixation**:
```bash
# Run client ‚Üí option 7
# Shows predictable session IDs
```

**Stale Permissions**:
```bash
# Run client ‚Üí option 8
# Shows role changes don't affect sessions
```

**Replay Attack**:
```bash
# Run client ‚Üí option 9
# Shows same request works multiple times
```

**No Authentication**:
```bash
# In client, try any agent_id
# No password needed, all accepted
```

**Privilege Escalation**:
```bash
# Login with role="admin"
# No verification, instant admin!
```

---

## üîç Code Locations

### task_coordinator.py

```python
# Vulnerability locations:

Line 45:     # VULNERABILITY 1: Predictable session IDs
             session_id = f"sess_{self.session_counter}"

Line 170:    # VULNERABILITY 15: No authentication
             # Anyone can create projects

Line 190:    # VULNERABILITY 6: Logout doesn't destroy
             # Session remains valid after logout

Line 220:    # VULNERABILITY 19: No authorization
             # No permission checking

Line 250:    # VULNERABILITY 22: No replay protection
             # Same request works infinitely
```

---

## üí° Attack Scenarios

### Scenario 1: Complete Takeover
```
1. Attacker connects (no auth required)
2. Guesses session ID: sess_1, sess_2, sess_3
3. Finds active session
4. Uses it to create/modify projects
5. Victim can't tell who did it
```

### Scenario 2: Privilege Escalation
```
1. Attacker logs in as "guest"
2. Claims role="admin" (client-side)
3. System accepts it (no verification)
4. Full administrative access
```

### Scenario 3: Replay Flood
```
1. Attacker captures one create request
2. Replays it 1000 times
3. Creates 1000 duplicate projects
4. System exhausts resources
```

### Scenario 4: Session Never Dies
```
1. User logs in at 9 AM ‚Üí sess_123
2. User logs out at 5 PM
3. Session sess_123 still valid!
4. Can be used forever
```

---

## üéì Learning Objectives

After testing these vulnerabilities:

‚úÖ Understand session lifecycle  
‚úÖ See why session validation matters  
‚úÖ Recognize predictable patterns  
‚úÖ Understand authentication vs authorization  
‚úÖ See replay attack mechanics  
‚úÖ Learn state management issues  

---

## üîÑ Next Steps

1. **Test all 25 vulnerabilities** using the client
2. **Read SECURITY_ANALYSIS.md** for deep dive
3. **Try to find more** vulnerabilities
4. **Move to Stage 2** to see basic improvements
5. **Study Stage 3** for production security

---

## üìö Related Docs

- [README.md](./README.md) - Full stage overview
- [SECURITY_ANALYSIS.md](./SECURITY_ANALYSIS.md) - Detailed analysis
- [Session Security Docs](../../../docs/a2a/03_SECURITY/06_session_state_security.md) - Theory

---

**Stage**: 1 (Insecure)  
**Security Rating**: 0/10 ‚ùå  
**Total Vulnerabilities**: 25+  
**All are exploitable**: Yes  
**Use in production**: NEVER

---

*This is intentionally vulnerable code for educational purposes only.*